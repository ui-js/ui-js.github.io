<!doctype html><html class=no-js lang=en><meta charset=utf-8><title>ui-js</title><meta content=""name=description><link href=/feed.xml rel=alternate title="ui-js Feed"type=application/atom+xml><meta content="width=device-width,initial-scale=1"name=viewport><meta content=strict-origin name=referrer><script>document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';</script><link href=/assets/css/main.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:100,100i,400,400i,700,700i,900,900i&display=block"rel=stylesheet crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=block"rel=stylesheet crossorigin><script crossorigin=anonymous src=https://kit.fontawesome.com/523e3eb8bb.js></script><body class=layout--single><nav class=skip-links><h2 class=screen-reader-text>Skip links</h2><ul><li><a href=#site-nav class=screen-reader-shortcut>Skip to primary navigation</a><li><a href=#main class=screen-reader-shortcut>Skip to content</a><li><a href=#footer class=screen-reader-shortcut>Skip to footer</a></ul></nav><!--[if lt IE 9]><div class="notice--danger align-center"style=margin:0>You are using an <strong>outdated</strong> browser. Please <a href=https://browsehappy.com/ >upgrade your browser</a> to improve your experience.</div><![endif]--><div class=masthead><div class=masthead__inner-wrap><div class=masthead__menu><nav class=greedy-nav id=site-nav><a href=/ class=site-logo><img src=""alt=""></a><a href=/ class=site-title>ui-<em>js</em></a><ul class=visible-links><li class=masthead__menu-item><a href=/blog title="ui-js Blog">Blog</a><li class=masthead__menu-item><a href=/web-components title="Web Components Documentation">Web Components</a><li class=masthead__menu-item><a href=https://gitter.im/cortex-js title="Chat on Gitter"><svg class=icon1em><use role=none xlink:href=/assets/icons.svg#gitter></use></svg></a><li class=masthead__menu-item><a href=https://github.com/ui-js title="Get source code on GitHub"><svg class=icon1em><use role=none xlink:href=/assets/icons.svg#github></use></svg></a></ul><button class="hidden greedy-nav__toggle"type=button><span class=visually-hidden>Toggle menu</span><div class=navicon></div></button><ul class="hidden hidden-links"></ul></nav></div></div></div><div class=initial-content><div id=main role=main><div class="sidebar sticky"><nav class=nav__list><input id=ac-toc name=accordion-toc type=checkbox> <label for=ac-toc><svg class="fa-ellipsis-h svg-inline--fa"aria-hidden=true data-icon=ellipsis-h data-prefix=fal focusable=false role=img style=width:32px;height:32px viewBox="0 0 320 512"xmlns=http://www.w3.org/2000/svg><path d="M192 256c0 17.7-14.3 32-32 32s-32-14.3-32-32 14.3-32 32-32 32 14.3 32 32zm88-32c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm-240 0c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32z"fill=currentColor></path></svg></label><ul class=nav__items><li><a href=/blog><span class=nav__sub-title>Blog</span></a><ul><li><a href=/blog/part-1-introduction>Part 1 - Introduction</a></ul><li><a href=/web-components><span class=nav__sub-title>Web Components</span></a></ul></nav></div><article class=page itemscope itemtype=https://schema.org/CreativeWork><div class=page__inner-wrap><header></header><section class=page__content itemprop=text><style>h1{font-size:5rem;line-height:.9;text-transform:uppercase;letter-spacing:-4px;font-weight:700;color:#303047}h1 .eyebrow{display:block;font-size:1rem;letter-spacing:0;font-weight:600;color:#aaa}</style><h1><span class=eyebrow>Part 1</span>Building a Modern Web App Framework</h1><p>In this series we’re going to build a modern web app framework from scratch.<p><em>“Oh no! Who needs another framework!?!”</em>, I hear you think. Fair enough.<p>But what better way to learn something than by building it? We will understand what it takes to build a framework and the tradeoffs involved. This will help us to make better use of existing frameworks, while having fun building our own.<p>This will also be an opportunity to put in practice <strong>architectural thinking</strong>: how to design from the start a complex piece of software by considering some initial requirements and anticipating future needs.<h2>Prerequisites</h2><p>Since our goal is to build an app framework for the web platform, we’ll assume you already have some familiarity with Javascript and HTML.<ul><li><p><strong>Javascript</strong>. We’ll be using the most recent version of Javascript, <a href=https://262.ecma-international.org/11.0/ >ES2020</a>, including features such as <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax>spread/rest operator</a> (<code>...</code>), <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining>optional chaining</a> (<code>?.</code>), <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator>nullish coalescing</a> (<code>??</code>), <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise>promises</a>, and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function><code>async/await</code></a>. We’ll also use Typescript, but these sections will be optional and we’ll introduce what you need to know as we go.<li><p><strong>HTML, CSS, DOM</strong>. If you’ve authored a web page in a text editor, you probably know enough to follow along.</ul><h2>What about my favorite framework?</h2><p>One of the beauty of the web platform is its fantastic diversity.<p>Other platforms tend to have a single (or two) frameworks designed by the platform vendors.<p>But in the web ecosystem, there’s a new framework becoming popular every week! This has encouraged a lot of experimentation and using different solutions to solve the same problems.<p>We’ll discuss the fundamental problems being solved by web app framework and possible solutions. We’ll also occasionally discuss in side notes how some the concepts introduced apply to specific frameworks, such as React, Vue, Svelte or Angular.<h2>I’m not a web developer!</h2><p>If you have a different background, such as UIKit, SwiftUI or Android, you probably won’t have too many difficulties following along and you’ll see that many of the topics discussed here apply as well. A modern web app is not fundamentally different from a mobile or desktop app.<h2>What’s the difference between a framework and a library?</h2><p>The difference between a library and a framework is summarized in the <a href=https://en.wikipedia.org/wiki/Inversion_of_control>The Hollywood Principle</a>: <strong>“Don’t call us, we’ll call you.”</strong> [1]<p>In a nutshell: a library provides a set of entry points (functions, classes, etc…) that the client app calls to perform certain functions. The client is responsible for orchestrating these calls.<p>On the other hand, a client provides to a framework a set of callbacks that the framework calls to respond to various events. The framework defines the flow of communication between software components.<p>A framework will usually require less boilerplate code to be written and will more strongly suggest a specific way to organize your code. In some cases you may find this to be an unwelcome constraint, but on the other hand it also provides useful guidelines to ensure the architecture of your web app is sound from the start. This is particularly important when building a complex app as getting started on the right footing will avoid having to do painful re-architecting later on as the app grows in complexity.<h2>Do I even need a framework?</h2><p>It depends on the complexity of what you build. For a blog, probably not. For an interactive web app with a complex state that needs to be persisted across user visits, an app framework will probably be useful.<p>Every web app starts very simple and at the beginning a framework may seem like unnecessary complexity. However, as your app grows, with features added, and people joining your team, a framework will help you scale.<h2>Application Architecture</h2><p>Before discussing what we need from a framework, let’s talk about how we’re going to structure our web app.<p>A web app is <a href=https://en.wikipedia.org/wiki/Multitier_architecture>typically</a> made of a <strong>frontend</strong> that runs in the browser and a <strong>backend</strong> that runs on remote servers.<p>The backend has one or more services that can serve requests and that stores data in a database of some kind.<p>With a static web site, a blog for example, the backend is also responsible for generating the content that is displayed in the browser: it sends directly to the browser HTML/CSS that is ready to be displayed.<p>But we’ll look at apps where the presentation (and interactivity) is happening in the browser. Those apps are sometimes called SPA (Single Page Apps) because the servers send a single page, and that page is responsible for orchestrating what is presented to the user and how to react to it. Furthermore, that single “page” can actually displays what appears to the user as multiple “pages”, but we’ll discuss that in more detail when we talk about “routing”.<figure><img src=/assets/blog/01-02.png style=max-height:500px><figcaption>Web App Architecture</figcaption></figure><p>Our framework will focus on the front and will help manage the presentation, business logic and data model of our app.<ul><li><strong>Presentation:</strong> the user interface, the set of on-screen components that the user interacts with. Its purpose is to display information to and collect information from the user. This will be represented with some HTML, CSS and JavaScript. This will be a collection of standardized components (buttons, menus, calendar widget, etc…) organized in ways that are specific to the application.<li><strong>Business Logic:</strong> This is the heart of the application. It builds and updates the presentation layer and handle the user input. It orchestrates the communication between the presentation and data model layers.<li><strong>Data model:</strong> It manages and handles the persistent storage of the data. The Data Model is ignorant of the Presentation layer. For example, a data model could be the content of a shopping cart: a list of item, each with a quantity. This could be represented in the Presentation layer as a list of item, or as a simple icon with a counter of the items in the shopping cart.</ul><p>Model-View-Controller, Model-View-Binder or Model-View-ViewModel<h2>What about backends?</h2><p>We’ll focus on front-end solutions, that is code that runs in the browser.<p>Most web app will include a server-side component, and there are server-side web app frameworks as well but that won’t be the focus of our discussion.<h2>Developer Ergonomics</h2><p>A web app framework is a tool for developers. <strong>Developer ergonomics</strong> is something that’s useful to think about whenever you are building an API that is intended to be used by other developers.<p>There’s no reason why an API shouldn’t be easy to learn and easy to use. Those two goals can be in conflict, so we’ll pay careful attention on how to balance them.<p><strong>Simplicity</strong><p>If you can minimize the number of new concepts that need to be mastered, your API will be easier to learn. We’ll assume that developers using our framework are familiar with the concepts of the web platform, including events and asynchronous operations. We will also assume that they are comfortable with the dynamic and polymorphic nature of JavaScript.<p>On the other hand we will not assume an understanding of <strong>Object-Oriented Programming</strong> or <strong>Functional Programming</strong> techniques. While our target audience may well be familiar with these concepts, we don’t have to make use of every single areas of knowledge our audience may have unless we can directly benefit from it.<blockquote><p>“Programs are meant to be read by humans and only incidentally for computers to execute.” – Donald Knuth</blockquote><p><strong>Consistency</strong><p>Learning a new API, or becoming proficient at using one, can be made tremendously easier if it is internally consistent, and consistent with other APIs the developer will already be familiar with. That consistency can manifest itself in the naming conventions for entry points and data structures and the idioms used (for example: an asynchronous function always return a <code>Promise</code>). By being consistent it becomes easier for the developer to “guess” how something is supposed to be used.<p><strong>Brevity</strong><p>A small API surface of expressive entry points is easier to learn. It is more difficult to find “the right entrypoint” in a large set. We’ll endeavor to keep a minimal set of entry points, a dozen or so, and we’ll make them flexible enough that they can be used for all the use cases.<blockquote><p>The utility of a language as a tool of thought increases with the range of topics it can treat, but decreases with the amount of vocabulary and the complexity of grammatical rules which the user must keep in mind. Economy of notation is therefore important. – Kenneth Iverson</blockquote><p><strong>Clarity</strong><p>Code is written once and read many times. It helps if the name of entry points clearly reflects what they are doing.<blockquote><p>As the saying goes: “There are only two hard things in Computer Science: cache invalidation, naming things and off-by-one errors”.</blockquote><p><strong>Correctness</strong><h2>Benefits of a framework?</h2><p>Let’s explore some of the common problems you will encounter as you try to build a large, complex, web app and how frameworks can help tackle them.<p>As in many software projects, a key challenge of building a web app is to manage complexity. In the case of a web app this complexity takes the form of the relationships between UI components and between UI components and the application state (data model).<p>As new UI components get added and as the data model get more complicated, the possible connections increase exponentially.<p>Managing complexity. Tracking connections is exponentially hard.<p>First, it’s useful to divide your app between <strong>state</strong> and <strong>ui</strong>.<p>The <strong>state</strong> of your app is the set of data<p>We will build an app in SwiftUI to see how Apple’s new framework approaches solving these problems.<p>A complex app:<ul><li>State that needs to be persisted.<li>Using API request to load data.<li>Multiple screens that need to communicate with each other.</ul><p>// https://jsonplaceholder.typicode.com/guide/<ul><li><p>Scalability. Could write everything by hand, but then you have to keep track of dependencies, in particular when the state of your app changes, which UI components need to be updated. Famous Facebook notification bug. Basically created React to squash that bug.<li><p>A good framework can do the bookkeeping for you, apply some optimization techniques, so you can focus on more abstract concepts.<li><p>Example of a naive approach: modify a state property, re-render the component(s) that depends on it. But what if other properties dependend on this property, and had other components dependending on <em>these</em> properties? Or maybe the same component depending on the original property and those indirect properties. Are you going to render more than you need to?</ul><h2>Features</h2><p>Principles?<p>Sinkhole anti-pattern where data/requests are just passed-through.<p>Brevity/Clarity: How much code do you have to read to understand something?<p>Goals:<ul><li>counter<li>todo</ul><p>Comparison with other frameworks<ul><li><p>tersness / brevity<li><p>clarity<li><p>consistency /<li><p>modularity - separation of concern<li><p>Don’t Repeat Yourself (DRY)<li><p>Single Source of Truth (SSOT)<li><p>Avoid Premature Abstraction. YAGNI (You Aren’t Gonna Need It)/KISS. Avoid premature abstraction. Software systems work best when they are kept simple. Avoiding unnecessary complexity will make your system more robust, easier to understand, easier to reason about, and easier to extend.<li><p>Principle Of Least Astonishment<li><p><a href=https://en.wikipedia.org/wiki/Law_of_Demeter>Law of Demeter</a>: don’t talk to strangers. a given object should assume as little as possible about the structure or properties of anything else (including its subcomponents), in accordance with the principle of “information hiding”. (use only one dot)<li><p>SOLID<ul><li>Single Responsibility Principle.<li>Open for Extension / Closed for Modifications<li>Liskov Substitution Principle: subclasses respect theit parent’s contract<li>Interface Segregation Principle: should not depend on interface you don’t use<li>Dependency Inversion Principle: higher-level modules should not depend on lower level modules, but on abstract interfaces</ul><li><p>Dependency injection: meant to preserve abstraction. But in a large app can lead to a proliferation of “manager”-like classes that need to have instances propagated down. Better to lift the dependencies and abstract them as data in the app state.</ul><h1>Future Posts</h1><ul><li><strong>Rendering</strong><li><strong>Messaging</strong><li><strong>State Management</strong><li><strong>Routing</strong></ul><p>[1] <a href=https://www.digibarn.com/friends/curbow/star/XDEPaper.pdf>Hollywood’s Law</a><blockquote><p>“A monad is a monoid in the category of endofunctors”</blockquote></section><footer class=page__meta><meta content="January 16, 2021"itemprop=datePublished><p class=page__date><strong><i aria-hidden=true class="fa-calendar-alt fa-fw fas"></i> Updated:</strong> <time datetime="Sat Jan 16 2021 08:59:34 GMT+0100 (Central European Standard Time)">January 16, 2021</time></footer></div></article></div></div><div class=page__footer id=footer><footer><div class=page__footer-follow><ul class=social-icons><li><a href=https://github.com/ui-js rel="nofollow noopener noreferrer"><svg class=icon1em><use role=none xlink:href=/assets/icons.svg#github></use></svg>GitHub</a><li><a href=https://gitter.im/cortex-js rel="nofollow noopener noreferrer"><svg class=icon1em><use role=none xlink:href=/assets/icons.svg#gitter></use></svg>Gitter</a></ul></div><div class=page__footer-pages><ul><li><a href=/about rel="nofollow noopener noreferrer">About Us</a></ul></div></footer></div>